namespace ipc.types;

enum XlError : short {
  Null = 2000,
  Div0 = 2007,
  Value = 2015,
  Ref = 2023,
  Name = 2029,
  Num = 2036,
  NA = 2042,
  GettingData = 2043,
  Spill = 2045,
  Connect = 2046,
  Blocked = 2047,
  Unknown = 2048,
  Field = 2049,
  Calc = 2050
}

table Bool { val: bool; }
table Num { val: double; }
table Int { val: int; }
table Str { val: string; }
table Err { val: XlError = Null; }
table AsyncHandle { val: ulong; }
table Nil { }
table RefCache { key: string; }

struct Rect {
  row_first: int;
  row_last: int;
  col_first: int;
  col_last: int;
}

table Range {
  sheet_name: string;
  refs: [Rect];
}

union ScalarValue { Bool, Num, Int, Str, Err, AsyncHandle, Nil }

table Scalar {
  val: ScalarValue;
}

table Grid {
  rows: int;
  cols: int;
  data: [Scalar];
}

table NumGrid {
  rows: int;
  cols: int;
  data: [double];
}

union AnyValue { Bool, Num, Int, Str, Err, AsyncHandle, Nil, Grid, NumGrid, Range, RefCache }

table Any {
  val: AnyValue;
}
