project:
  name: "{{.ProjectName}}"
  version: "0.1.0"

# Code generation settings
gen:
  go:
    package: "generated"
  disable_pid_suffix: true # Optional: If true, prevents appending the PID to the shared memory name. Default is false.

# Build configuration
logging:
  # Log level (DEBUG, INFO, WARN, ERROR)
  level: "{{if .DevMode}}DEBUG{{else}}INFO{{end}}"
  # Directory for log files (${XLL_DIR}, ${BIN_DIR}, ${TEMP}, or absolute path)
  dir: "{{if .DevMode}}${XLL_DIR}{{else}}${BIN_DIR}{{end}}"

build:
  # Build strategy:
  # - standalone: XLL and Go executable are separate files.
  # - xll: Go executable is embedded into the XLL (single-file distribution).
  singlefile: "{{if .DevMode}}{{else}}xll{{end}}"
  # Directory pattern for temporary extraction (only for singlefile: xll)
  temp_dir: ""

# Go server process configuration
server:
  timeout: "10s" # Default timeout for synchronous function calls.
  async_ack_timeout: "2s" # Optional: Timeout for acknowledging asynchronous requests.
  workers: 0 # Size of the worker pool for processing requests. 0 means use runtime.NumCPU().
  launch:
    enabled: true # If true, the XLL automatically launches the Go server.
    # Variable substitution:
    #   ${BIN}      - The full path to the server executable. (Available in 'command')
    #   ${BIN_DIR}  - The directory containing the server executable. (Available in 'cwd')
    #   ${XLL_DIR}  - The directory containing the XLL file. (Available in 'cwd')
    #
    # Examples:
    #   cwd: "${XLL_DIR}/data"
    command: "${BIN}" # Optional: Command to launch the server. ${BIN} resolves to the executable path.
    cwd: "${BIN_DIR}" # Optional: Working directory for the server process. Defaults to the directory containing the executable.

# Real-Time Data (RTD) Server Configuration
rtd:
  enabled: false
  # prog_id: "{{.ProjectName}}.RTD" # The ProgID for the RTD server (e.g., MyProject.RTD).
  # clsid: "" # Optional: Specific CLSID. If empty, one will be generated.
  # description: "My RTD Server" # Optional: Description of the RTD server.

# Function Definitions
# Supported argument/return types: int, float, string, bool, range, grid, numgrid, any
functions:
  # Simple integer addition
  - name: "Add"
    description: "Adds two integers"
    category: "Math"
    # volatile: false # Optional: If true, recalculates on any sheet change. Default is false.
    # async: false # Optional: Marks the function as asynchronous. Default is false.
    # shortcut: "" # Optional: Keyboard shortcut, e.g., "Ctrl+Shift+A".
    # help_topic: "" # Optional: URL or path to a help topic file.
    # timeout: "" # Optional: Overrides the global server timeout for this specific function.
    # caller: false # Optional: If true, provides the calling cell's reference as the first argument to your Go function. Default is false.
    args:
      - name: "a"
        type: "int"
        description: "First number"
      - name: "b"
        type: "int"
        description: "Second number"
    return: "int"

  # Async function example
  - name: "GetPrice"
    description: "Fetches price (Async simulation)"
    category: "Finance"
    args:
      - name: "ticker"
        type: "string"
        description: "Ticker symbol (e.g., AAPL, GOOG)"
    return: "float"
    async: true

  # String manipulation
  - name: "Greet"
    description: "Returns a greeting message"
    category: "Text"
    args:
      - name: "name"
        type: "string"
        description: "Name to greet"
    return: "string"

  # Boolean logic
  - name: "IsEven"
    description: "Checks if a number is even"
    category: "Logic"
    args:
      - name: "val"
        type: "int"
        description: "Value to check"
    return: "bool"

# Event Handlers (Optional)
#
# Subscribe to Excel events and execute Go code in response. For example,
# you can refresh data when a calculation cycle completes.
#
# events:
#   # Example: A handler for the 'CalculationEnded' event.
#   - type: "CalculationEnded" # The type of Excel event.
#     name: "OnCalculationEnded" # The name for the generated Go handler function.
#     description: "Handles the end of a calculation cycle."
