project:
  name: "{{.ProjectName}}"
  version: "0.1.0"

# Code generation settings
gen:
  go:
    package: "generated"
  # disable_pid_suffix: false # Optional: If true, prevents appending the PID to the shared memory name. Default is false.

# Build configuration
build:
  # singlefile: "xll" # Optional: "xll" to embed Go server in XLL. "exe" is reserved.
  # temp_dir: "${TEMP}" # Optional: Directory for extracting embedded binaries. Supports environment variables. Default is "${TEMP}".

# Logging configuration
logging:
  level: "info" # debug, info, warn, error
  path: "{{.ProjectName}}.log" # Log file path.

# Go server process configuration
server:
  timeout: "10s" # Default timeout for synchronous function calls.
  # async_ack_timeout: "1s" # Optional: Timeout for acknowledging asynchronous requests.
  workers: 0 # Size of the worker pool for processing requests. 0 means use runtime.NumCPU().
  launch:
    enabled: true # If true, the XLL automatically launches the Go server.
    command: "./{{.ProjectName}}.exe" # Optional: Command to launch the server. Defaults to the project executable.
    cwd: "." # Optional: Working directory for the server process. Defaults to the XLL directory.

# Function Definitions
# Supported argument/return types: int, float, string, bool, range, grid, numgrid, any
functions:
  # Simple integer addition
  - name: "Add"
    description: "Adds two integers"
    category: "Math"
    # volatile: false # Optional: If true, recalculates on any sheet change. Default is false.
    # async: false # Optional: Marks the function as asynchronous. Default is false.
    # shortcut: "" # Optional: Keyboard shortcut, e.g., "Ctrl+Shift+A".
    # help_topic: "" # Optional: URL or path to a help topic file.
    # timeout: "" # Optional: Overrides the global server timeout for this specific function.
    # caller: false # Optional: If true, provides the calling cell's reference as the first argument to your Go function. Default is false.
    args:
      - name: "a"
        type: "int"
        description: "First number"
      - name: "b"
        type: "int"
        description: "Second number"
    return: "int"

  # Async function example
  - name: "GetPrice"
    description: "Fetches price for a ticker (Async simulation)"
    category: "Finance"
    args:
      - name: "ticker"
        type: "string"
        description: "Stock Ticker"
    return: "float"
    async: true

  # String manipulation
  - name: "Greet"
    description: "Returns a greeting message"
    category: "Text"
    args:
      - name: "name"
        type: "string"
        description: "Name to greet"
    return: "string"

  # Boolean logic
  - name: "IsEven"
    description: "Checks if a number is even"
    category: "Logic"
    args:
      - name: "val"
        type: "int"
        description: "Value to check"
    return: "bool"

# Event Handlers (Optional)
#
# Subscribe to Excel events and execute Go code in response. For example,
# you can refresh data when a calculation cycle completes.
#
# events:
#   # Example: A handler for the 'CalculationEnded' event.
#   - type: "CalculationEnded" # The type of Excel event.
#     name: "OnCalculationEnded" # The name for the generated Go handler function.
#     description: "Handles the end of a calculation cycle."
