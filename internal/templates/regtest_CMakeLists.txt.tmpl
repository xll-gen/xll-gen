cmake_minimum_required(VERSION 3.14)
project(mock_host LANGUAGES CXX)

set(CMAKE_CXX_STANDARD 17)

include(FetchContent)

# Flatbuffers
FetchContent_Declare(
  flatbuffers
  GIT_REPOSITORY https://github.com/google/flatbuffers.git
  GIT_TAG v25.9.23
)
FetchContent_MakeAvailable(flatbuffers)

# SHM
FetchContent_Declare(
  shm
  GIT_REPOSITORY https://github.com/xll-gen/shm.git
  GIT_TAG b4722d88e8da
)
FetchContent_MakeAvailable(shm)

if(NOT TARGET shm)
  add_library(shm INTERFACE)
  target_include_directories(shm INTERFACE ${shm_SOURCE_DIR}/include)
endif()

add_executable(mock_host main.cpp)

# Include generated headers from main project
target_include_directories(mock_host PRIVATE ../generated/cpp)

target_link_libraries(mock_host PRIVATE
  shm
  flatbuffers
)
